---
title: Linear algebra basics
author: ~
date: '2019-11-22'
slug: linear-algebra-basics
categories: []
tags: []
description: "Basic review of linear algebra" 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Vector

## Linear combination of vectors

A linear combination is the union of two basic vector operation : addition of vectors and multiplication of a vector by a scalar.

#### Addition of vectors 

$$v = \begin{bmatrix}
v_1 \\
v_2
\end{bmatrix}
\qquad
\qquad
w = \begin{bmatrix}
w_1 \\
w_2
\end{bmatrix}
\qquad\qquad
v + w = \begin{bmatrix}
v_1 + w_1 \\
v_2 + w_2
\end{bmatrix}$$


```{r}
v <- c(1,5)
w <- c(2,2)
u <- v+w

x_max = ceiling((v[1]+w[1])*1.2)
y_max = ceiling((v[2]+w[2])*1.2)

plot(0,0, xlim=c(0,x_max), ylim=c(0,y_max))
arrows(0,0,v[1],v[2], col="red")
arrows(v[1],v[2],v[1]+w[1],v[2]+w[2], col="green")
arrows(0,0,u[1],u[2], col="blue")

legend(0, y_max, legend=c("vector v", "vector w", "vector (v+w)"),
       col=c("red", "green", "blue"), lty=c(1,1,1))
```

#### Scalar multiplication

$$a.v = \begin{bmatrix}
a.v_1 \\
a.v_2
\end{bmatrix}$$

```{r}
v <- c(6,5)
a <- 2
w <- a*v

x_max <- ceiling(w[1]*1.2)
y_max <- ceiling(w[2]*1.2)

plot(0,0, xlim=c(0,x_max), ylim=c(0,y_max))
arrows(0,0,w[1],w[2], col="green")
arrows(0,0,v[1],v[2], col="red")

legend(0, y_max, legend=c("vector v", "vector a*v"),
       col=c("red", "green"), lty=c(1,1,1))
```

$a.v + b.w$ is a linear combination of v and w d w

## Dot product

#### Definition

The dot product is defined by :

$$v \cdot w = v_1w_1 + v_2w_2 + ... + v_nw_n$$

#### Length of a vector 

To compute the square of the vector length we use:

$$ ||v||^2 = v_1^2 + ... + v_n^2 $$

so :

$$||v|| = \sqrt{v \cdot v}$$

#### Unit vector

A unit vector is a vector of length 1:

$$u = \frac{v}{||v||}$$

If two vectors v,w are unit vector, the dot product is $\cos\theta$ :

$$\frac{v \cdot w}{||v||||w||} = \cos \theta$$

So we see the Schwarf inequality :

$$|x \cdot w| \leq ||v||||w||$$

and the triangle inequality :

$$||v + w|| \leq ||v|| + ||w||$$


## Matrices 

A matrix is a set of columns :

$$u = \begin{bmatrix}
u_1 \\
u_2 \\
u_3
\end{bmatrix},
\qquad
v = \begin{bmatrix}
v_1 \\
v_2 \\
v_3
\end{bmatrix},
\qquad
w = \begin{bmatrix}
w_1 \\
w_2 \\
w_3
\end{bmatrix}
\qquad \qquad
A = \begin{bmatrix}
u & v & w
\end{bmatrix}$$

Matrix times vector is a vector combination of columns of the matrix :

$$Ax = \begin{bmatrix}
u & v & w
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix} = 
x_1u + x_2v + x_3w = 
\begin{bmatrix}
b_1 \\
b_2 \\
b_3 
\end{bmatrix}=
b$$

#### Linear equations

We can express a equation system with matrix :

$$Ax = b$$

$x$ is the unknow vector, we are looking for what combination of u, v, w gives b.

$$x = A^{-1}b$$

#### Dependence and independence

##### Dependence 

* A column is a linear combination of the others
* There is a combination that gives the null vector ($Ax = 0$ has many solution)
* A is a singular matrix

##### Independence

* Every column is not a linear combination of the others
* There is no combination that gives the null vector ($Ax = 0$ has one trivial solution)
* A is a invertible matrix

# 2. Solving linear equation

## Vectors and linear equation

#### Rows picture

$$a_11x + a_12y = b_1$$
$$a_21x + a_22y = b_2$$

We look for the point of intersection of the two lines :

```{r}
A = cbind(c(1,3), c(2,4))
b = c(3,-10)

if(det(A)!=0){
    x = solve(A,b)
    plot(x[1],x[2], xlim=c(min(x[1],0)*1.5,max(x[1],0)*1.5), ylim=c(min(x[2],0)*1.5,max(x[2],0)*1.5))
} else{
    plot(0,0, xlim=c(-5,5), ylim=c(-5,5), type="n")
}
abline(b=-(A[1,1]/A[1,2]), a=b[1]/A[1,2])
abline(b=-(A[2,1]/A[2,2]), a=b[2]/A[2,2])
```

* The solution is the meeting point of the lines described by the equations
* If the lines are parallel, there is no meeting point, so no solution
* If the meeting point is a line, the is a infinity of solution 

#### Columns picture

$$\begin{bmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{bmatrix}
\begin{bmatrix}
x \\
y
\end{bmatrix}
= 
\begin{bmatrix}
b_1 \\
b_2
\end{bmatrix}$$



We look for the combination of the columns of $A$ which gives $b$ :


```{r}
a_1 <- c(A[1,1],A[2,1])
a_2 <- c(A[1,2],A[2,2])

if(det(A) != 0){
    a_1_comb <- a_1*x[1]
    a_2_comb <- a_2*x[2]
    x_max <- ceiling(max(0, a_1[1], a_2[1], a_1_comb[1], a_2_comb[1], (a_1_comb + a_2_comb)[1])*1.2)
    x_min <- ceiling((min(0, a_1[1], a_2[1], a_1_comb[1], a_2_comb[1],(a_1_comb + a_2_comb)[1])-1)*1.2)
    y_max <- ceiling(max(0, a_1[2], a_2[2], a_1_comb[2], a_2_comb[2], (a_1_comb + a_2_comb)[2])*1.2)
    y_min <- ceiling((min(0, a_1[2], a_2[2], a_1_comb[2], a_2_comb[2], (a_1_comb + a_2_comb)[2])-1)*1.2)
} else {
    x_max <- ceiling(max(0, a_1[1], a_2[1], a_1_comb[1], a_2_comb[1])*1.2)
    x_min <- ceiling((min(0, a_1[1], a_2[1], a_1_comb[1], a_2_comb[1])-1)*1.2)
    y_max <- ceiling(max(0, a_1[2], a_2[2], a_1_comb[2], a_2_comb[2])*1.2)
    y_min <- ceiling((min(0, a_1[2], a_2[2], a_1_comb[2], a_2_comb[2])-1)*1.2) 
}


plot(0,0, xlim=c(x_min,x_max), ylim=c(y_min,y_max))
arrows(0,0,a_1[1],a_1[2], col="red")
arrows(0,0,a_2[1],a_2[2], col="red")

if(det(A) != 0){
    arrows(0,0,a_1_comb[1],a_1_comb[2], col="green")
    arrows(0,0,a_2_comb[1],a_2_comb[2], col="green")
    arrows(a_1_comb[1],a_1_comb[2],(a_1_comb+a_2_comb)[1],(a_1_comb+a_2_comb)[2], col="green", lty="dashed")
}
arrows(0,0, b[1], b[2], col="blue")
legend(x_min, y_max, legend=c("Original vector", "Multiplied vector", "Result"),
       col=c("red", "green", "blue"), lty=c(1,1,1))
```

* The solution is the vector of coefficient of the linear combination of the columns that gives the vector b
* If the columns are dependent and the vector $b$ is not in the column space there is no solution
* If the columns are dependent and the vector $b$ is in the column space there is an infinity of solutions

## Elimination

Elimination produce an upper triangular systÃ¨me :

$$\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  a_{21}x + a_{22}y = b_2
\end{array}
\right.$$


$$\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  cy = d
\end{array}
\right.$$

We multiply equation 1 to substract from equation 2 and eliminate a component. The solution is not altered by this process. 

**Pivot** : first non-zero in the rows that does the elimination

**Multiplier** : (entry to eliminate) divided by (pivot)

```{r}
library(matrixcalc)
library(cowplot)

#adapts the size of the plot
options(repr.plot.width=16, repr.plot.height=6)

A = cbind(c(1,2), c(3,4))
b = c(3,4)

x = solve(A,b)

U = lu.decomposition(A)$U
L = lu.decomposition(A)$L

c = solve(L,b)
x = solve(U,c)

par(mfrow=c(1,2))

plot(x[1],x[2], xlim=c(min(x[1],0)*1.5,max(x[1],0)*1.5), ylim=c(min(x[2],0)*1.5,max(x[2],0)*1.5))
abline(b=-(A[1,1]/A[1,2]), a=b[1]/A[1,2])
abline(b=-(A[2,1]/A[2,2]), a=b[2]/A[2,2])

plot(x[1],x[2], xlim=c(min(x[1],0)*1.5,max(x[1],0)*1.5), ylim=c(min(x[2],0)*1.5,max(x[2],0)*1.5))
abline(b=-(U[1,1]/U[1,2]), a=c[1]/U[1,2])
abline(b=-(U[2,1]/U[2,2]), a=c[2]/U[2,2])
```


