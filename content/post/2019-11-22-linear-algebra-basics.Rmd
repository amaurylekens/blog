---
title: Linear algebra basics
author: ~
date: '2019-11-22'
slug: linear-algebra-basics
categories: []
tags: []
description: "Basic review of linear algebra" 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Vector

## Linear combination of vectors

A linear combination is the union of two basic vector operation : addition of vectors and multiplication of a vector by a scalar.

#### Addition of vectors 

$$v = \begin{bmatrix}
v_1 \\
v_2
\end{bmatrix}
\qquad
\qquad
w = \begin{bmatrix}
w_1 \\
w_2
\end{bmatrix}
\qquad\qquad
u = v + w = \begin{bmatrix}
v_1 + w_1 \\
v_2 + w_2
\end{bmatrix}$$


```{r}
library(ggplot2)
v <- c(1,-2)
w <- c(-32,2)
u <- v+w

arrow = arrow(angle = 10, type = "closed", length = unit(0.10, "inches"), ends = "last")
cols <- c("vector v"="green", "vector w"="red", "vector u"="blue" )
data = data.frame(rbind(c(0,0),v,v,(v+w),c(0,0),u))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color="vector v"), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color="vector w"), arrow = arrow) +
  geom_segment(data=data[5:6,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color="vector u"), arrow = arrow) +
  scale_colour_manual(name="Legend",values=cols) +
  ggtitle("Sum of vectors") +
  xlab("x") + 
  ylab("y") +
  theme(plot.title = element_text(hjust=0.5, face="bold", size="15"),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))
```

#### Scalar multiplication

$$a.v = \begin{bmatrix}
a.v_1 \\
a.v_2
\end{bmatrix}$$

```{r}
v <- c(6,5)
a <- 2
w <- a*v

cols <- c("vector v"="green", "vector w"="blue")
data = data.frame(rbind(c(0,0), w, c(0,0), v))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color="vector v"), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color="vector w"), arrow = arrow) +
  scale_colour_manual(name="Legend",values=cols) +
  ggtitle("Multiplication by a scalar") +
  xlab("x") + 
  ylab("y") +
  theme(plot.title = element_text(hjust=0.5, face="bold", size="15"),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))
```

$a.v + b.w$ is a linear combination of v and w d w

## Dot product

#### Definition

The dot product is defined by :

$$v \cdot w = v_1w_1 + v_2w_2 + ... + v_nw_n$$

#### Length of a vector 

To compute the square of the vector length we use:

$$ ||v||^2 = v_1^2 + ... + v_n^2 $$

so :

$$||v|| = \sqrt{v \cdot v}$$

#### Unit vector

A unit vector is a vector of length 1:

$$u = \frac{v}{||v||}$$

If two vectors v,w are unit vector, the dot product is $\cos\theta$ :

$$\frac{v \cdot w}{||v||||w||} = \cos \theta$$

So we see the Schwarf inequality :

$$|x \cdot w| \leq ||v||||w||$$

and the triangle inequality :

$$||v + w|| \leq ||v|| + ||w||$$


## Matrices 

A matrix is a set of columns :

$$u = \begin{bmatrix}
u_1 \\
u_2 \\
u_3
\end{bmatrix},
\qquad
v = \begin{bmatrix}
v_1 \\
v_2 \\
v_3
\end{bmatrix},
\qquad
w = \begin{bmatrix}
w_1 \\
w_2 \\
w_3
\end{bmatrix}
\qquad \qquad
A = \begin{bmatrix}
u & v & w
\end{bmatrix}$$

Matrix times vector is a vector combination of columns of the matrix :

$$Ax = \begin{bmatrix}
u & v & w
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix} = 
x_1u + x_2v + x_3w = 
\begin{bmatrix}
b_1 \\
b_2 \\
b_3 
\end{bmatrix}=
b$$

#### Linear equations

We can express a equation system with matrix :

$$Ax = b$$

$x$ is the unknow vector, we are looking for what combination of u, v, w gives b.

$$x = A^{-1}b$$

#### Dependence and independence

##### Dependence 

* A column is a linear combination of the others
* There is a combination that gives the null vector ($Ax = 0$ has many solution)
* A is a singular matrix

##### Independence

* Every column is not a linear combination of the others
* There is no combination that gives the null vector ($Ax = 0$ has one trivial solution)
* A is a invertible matrix

# 2. Solving linear equation

## Vectors and linear equation

#### Rows picture

$$a_11x + a_12y = b_1$$
$$a_21x + a_22y = b_2$$

We look for the point of intersection of the two lines :

```{r}
A = cbind(c(1,3), c(2,4))
b = c(3,-10)

if(det(A)!=0){
    x = solve(A,b)
} 

ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name="x", limits=c(min(x[1],0)*1.5,max(x[1],0)*1.5)) +
  scale_y_continuous(name="y", limits=c(min(x[2],0)*1.5,max(x[2],0)*1.5)) +
  geom_abline(slope=-(A[1,1]/A[1,2]), intercept=b[1]/A[1,2]) +
  geom_abline(slope=-(A[2,1]/A[2,2]), intercept=b[2]/A[2,2]) +
  geom_point(aes(x=x[1], y=x[2]))
```

* The solution is the meeting point of the lines described by the equations
* If the lines are parallel, there is no meeting point, so no solution
* If the meeting point is a line, the is a infinity of solution 

#### Columns picture

$$\begin{bmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{bmatrix}
\begin{bmatrix}
x \\
y
\end{bmatrix}
= 
\begin{bmatrix}
b_1 \\
b_2
\end{bmatrix}$$



We look for the combination of the columns of $A$ which gives $b$ :


```{r}
a_1 <- c(A[1,1],A[2,1])
a_2 <- c(A[1,2],A[2,2])

if(det(A) != 0){
    a_1_comb <- a_1*x[1]
    a_2_comb <- a_2*x[2]
    u = a_1_comb + a_2_comb
}

cols <- c("original vector"="red", "multiplied vector"="green", "result"="blue")
data = data.frame(rbind(c(0,0), a_1, c(0,0), a_2, c(0,0), a_1_comb, c(0,0), 
                        a_2_comb, a_1_comb, (a_1_comb+a_2_comb), c(0,0), u))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color="original vector"), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color="original vector"), arrow = arrow) +
  geom_segment(data=data[5:6,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2], 
                                    color="multiplied vector"), arrow = arrow) +
  geom_segment(data=data[7:8,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color="multiplied vector"), arrow = arrow) +
  geom_segment(data=data[9:10,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                     color="multiplied vector"), arrow = arrow, lty="dashed") +
  geom_segment(data=data[11:12,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color="result"), arrow = arrow) +
  scale_colour_manual(name="Legend",values=cols) +
  ggtitle("Multiplication by a scalar") +
  xlab("x") + 
  ylab("y") +
  theme(plot.title = element_text(hjust=0.5, face="bold", size="15"),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))


```

* The solution is the vector of coefficient of the linear combination of the columns that gives the vector b
* If the columns are dependent and the vector $b$ is not in the column space there is no solution
* If the columns are dependent and the vector $b$ is in the column space there is an infinity of solutions

## Elimination

Elimination produce an upper triangular systÃ¨me :

$$\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  a_{21}x + a_{22}y = b_2
\end{array}
\right.$$


$$\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  cy = d
\end{array}
\right.$$

We multiply equation 1 to substract from equation 2 and eliminate a component. The solution is not altered by this process. 

**Pivot** : first non-zero in the rows that does the elimination

**Multiplier** : (entry to eliminate) divided by (pivot)

```{r}
library(matrixcalc)

#adapts the size of the plot
options(repr.plot.width=16, repr.plot.height=6)

A = cbind(c(1,2), c(3,4))
b = c(3,4)

x = solve(A,b)

U = lu.decomposition(A)$U
L = lu.decomposition(A)$L

c = solve(L,b)
x = solve(U,c)

x_lim = c(min(x[1],0)-1,max(x[1],0)+1)
y_lim = c(min(x[2],0)-1,max(x[2],0)+1)

p1 <- ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name="x", limits=x_lim) +
  scale_y_continuous(name="y", limits=y_lim) +
  geom_abline(slope=-(A[1,1]/A[1,2]), intercept=b[1]/A[1,2]) +
  geom_abline(slope=-(A[2,1]/A[2,2]), intercept=b[2]/A[2,2]) +
  geom_point(aes(x=x[1], y=x[2])) +
  ggtitle("Before elimination") +
  theme(plot.title = element_text(hjust=0.5, face="bold", size="15"))

p2 <- ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name="x", limits=x_lim) +
  scale_y_continuous(name="y", limits=y_lim) +
  geom_abline(slope=-(U[1,1]/U[1,2]), intercept=c[1]/U[1,2]) +
  geom_abline(slope=-(U[2,1]/U[2,2]), intercept=c[2]/U[2,2]) +
  geom_point(aes(x=x[1], y=x[2])) +
  ggtitle("After elimination") +
  theme(plot.title = element_text(hjust=0.5, face="bold", size="15"))

cowplot::plot_grid(p1, p2, labels = c("",""))
```
```


