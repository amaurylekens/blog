---
title: Linear algebra basics
author: ~
date: '2019-11-22'
slug: linear-algebra-basics
categories: []
tags: []
description: "Basic review of linear algebra" 
---



<div id="vector" class="section level1">
<h1>1. Vector</h1>
<div id="linear-combination-of-vectors" class="section level2">
<h2>Linear combination of vectors</h2>
<p>A linear combination is the union of two basic vector operation : addition of vectors and multiplication of a vector by a scalar.</p>
<div id="addition-of-vectors" class="section level4">
<h4>Addition of vectors</h4>
<p><span class="math display">\[v = \begin{bmatrix}
v_1 \\
v_2
\end{bmatrix}
\qquad
\qquad
w = \begin{bmatrix}
w_1 \\
w_2
\end{bmatrix}
\qquad\qquad
u = v + w = \begin{bmatrix}
v_1 + w_1 \\
v_2 + w_2
\end{bmatrix}\]</span></p>
<pre class="r"><code>library(ggplot2)
v &lt;- c(1,-2)
w &lt;- c(-32,2)
u &lt;- v+w

arrow = arrow(angle = 10, type = &quot;closed&quot;, length = unit(0.10, &quot;inches&quot;), ends = &quot;last&quot;)
cols &lt;- c(&quot;vector v&quot;=&quot;green&quot;, &quot;vector w&quot;=&quot;red&quot;, &quot;vector u&quot;=&quot;blue&quot; )
data = data.frame(rbind(c(0,0),v,v,(v+w),c(0,0),u))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color=&quot;vector v&quot;), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color=&quot;vector w&quot;), arrow = arrow) +
  geom_segment(data=data[5:6,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color=&quot;vector u&quot;), arrow = arrow) +
  scale_colour_manual(name=&quot;Legend&quot;,values=cols) +
  ggtitle(&quot;Sum of vectors&quot;) +
  xlab(&quot;x&quot;) + 
  ylab(&quot;y&quot;) +
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;, size=&quot;15&quot;),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))</code></pre>
<p><img src="/post/2019-11-22-linear-algebra-basics_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="scalar-multiplication" class="section level4">
<h4>Scalar multiplication</h4>
<p><span class="math display">\[a.v = \begin{bmatrix}
a.v_1 \\
a.v_2
\end{bmatrix}\]</span></p>
<pre class="r"><code>v &lt;- c(6,5)
a &lt;- 2
w &lt;- a*v

cols &lt;- c(&quot;vector v&quot;=&quot;green&quot;, &quot;vector w&quot;=&quot;blue&quot;)
data = data.frame(rbind(c(0,0), w, c(0,0), v))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color=&quot;vector v&quot;), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],color=&quot;vector w&quot;), arrow = arrow) +
  scale_colour_manual(name=&quot;Legend&quot;,values=cols) +
  ggtitle(&quot;Multiplication by a scalar&quot;) +
  xlab(&quot;x&quot;) + 
  ylab(&quot;y&quot;) +
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;, size=&quot;15&quot;),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))</code></pre>
<p><img src="/post/2019-11-22-linear-algebra-basics_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p><span class="math inline">\(a.v + b.w\)</span> is a linear combination of v and w d w</p>
</div>
</div>
<div id="dot-product" class="section level2">
<h2>Dot product</h2>
<div id="definition" class="section level4">
<h4>Definition</h4>
<p>The dot product is defined by :</p>
<p><span class="math display">\[v \cdot w = v_1w_1 + v_2w_2 + ... + v_nw_n\]</span></p>
</div>
<div id="length-of-a-vector" class="section level4">
<h4>Length of a vector</h4>
<p>To compute the square of the vector length we use:</p>
<p><span class="math display">\[ ||v||^2 = v_1^2 + ... + v_n^2 \]</span></p>
<p>so :</p>
<p><span class="math display">\[||v|| = \sqrt{v \cdot v}\]</span></p>
</div>
<div id="unit-vector" class="section level4">
<h4>Unit vector</h4>
<p>A unit vector is a vector of length 1:</p>
<p><span class="math display">\[u = \frac{v}{||v||}\]</span></p>
<p>If two vectors v,w are unit vector, the dot product is <span class="math inline">\(\cos\theta\)</span> :</p>
<p><span class="math display">\[\frac{v \cdot w}{||v||||w||} = \cos \theta\]</span></p>
<p>So we see the Schwarf inequality :</p>
<p><span class="math display">\[|x \cdot w| \leq ||v||||w||\]</span></p>
<p>and the triangle inequality :</p>
<p><span class="math display">\[||v + w|| \leq ||v|| + ||w||\]</span></p>
</div>
</div>
<div id="matrices" class="section level2">
<h2>Matrices</h2>
<p>A matrix is a set of columns :</p>
<p><span class="math display">\[u = \begin{bmatrix}
u_1 \\
u_2 \\
u_3
\end{bmatrix},
\qquad
v = \begin{bmatrix}
v_1 \\
v_2 \\
v_3
\end{bmatrix},
\qquad
w = \begin{bmatrix}
w_1 \\
w_2 \\
w_3
\end{bmatrix}
\qquad \qquad
A = \begin{bmatrix}
u &amp; v &amp; w
\end{bmatrix}\]</span></p>
<p>Matrix times vector is a vector combination of columns of the matrix :</p>
<p><span class="math display">\[Ax = \begin{bmatrix}
u &amp; v &amp; w
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix} = 
x_1u + x_2v + x_3w = 
\begin{bmatrix}
b_1 \\
b_2 \\
b_3 
\end{bmatrix}=
b\]</span></p>
<div id="linear-equations" class="section level4">
<h4>Linear equations</h4>
<p>We can express a equation system with matrix :</p>
<p><span class="math display">\[Ax = b\]</span></p>
<p><span class="math inline">\(x\)</span> is the unknow vector, we are looking for what combination of u, v, w gives b.</p>
<p><span class="math display">\[x = A^{-1}b\]</span></p>
</div>
<div id="dependence-and-independence" class="section level4">
<h4>Dependence and independence</h4>
<div id="dependence" class="section level5">
<h5>Dependence</h5>
<ul>
<li>A column is a linear combination of the others</li>
<li>There is a combination that gives the null vector (<span class="math inline">\(Ax = 0\)</span> has many solution)</li>
<li>A is a singular matrix</li>
</ul>
</div>
<div id="independence" class="section level5">
<h5>Independence</h5>
<ul>
<li>Every column is not a linear combination of the others</li>
<li>There is no combination that gives the null vector (<span class="math inline">\(Ax = 0\)</span> has one trivial solution)</li>
<li>A is a invertible matrix</li>
</ul>
</div>
</div>
</div>
</div>
<div id="solving-linear-equation" class="section level1">
<h1>2. Solving linear equation</h1>
<div id="vectors-and-linear-equation" class="section level2">
<h2>Vectors and linear equation</h2>
<div id="rows-picture" class="section level4">
<h4>Rows picture</h4>
<p><span class="math display">\[a_11x + a_12y = b_1\]</span>
<span class="math display">\[a_21x + a_22y = b_2\]</span></p>
<p>We look for the point of intersection of the two lines :</p>
<pre class="r"><code>A = cbind(c(1,3), c(2,4))
b = c(3,-10)

if(det(A)!=0){
    x = solve(A,b)
} 

ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name=&quot;x&quot;, limits=c(min(x[1],0)*1.5,max(x[1],0)*1.5)) +
  scale_y_continuous(name=&quot;y&quot;, limits=c(min(x[2],0)*1.5,max(x[2],0)*1.5)) +
  geom_abline(slope=-(A[1,1]/A[1,2]), intercept=b[1]/A[1,2]) +
  geom_abline(slope=-(A[2,1]/A[2,2]), intercept=b[2]/A[2,2]) +
  geom_point(aes(x=x[1], y=x[2]))</code></pre>
<p><img src="/post/2019-11-22-linear-algebra-basics_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li>The solution is the meeting point of the lines described by the equations</li>
<li>If the lines are parallel, there is no meeting point, so no solution</li>
<li>If the meeting point is a line, the is a infinity of solution</li>
</ul>
</div>
<div id="columns-picture" class="section level4">
<h4>Columns picture</h4>
<p><span class="math display">\[\begin{bmatrix}
a_{11} &amp; a_{12} \\
a_{21} &amp; a_{22}
\end{bmatrix}
\begin{bmatrix}
x \\
y
\end{bmatrix}
= 
\begin{bmatrix}
b_1 \\
b_2
\end{bmatrix}\]</span></p>
<p>We look for the combination of the columns of <span class="math inline">\(A\)</span> which gives <span class="math inline">\(b\)</span> :</p>
<pre class="r"><code>a_1 &lt;- c(A[1,1],A[2,1])
a_2 &lt;- c(A[1,2],A[2,2])

if(det(A) != 0){
    a_1_comb &lt;- a_1*x[1]
    a_2_comb &lt;- a_2*x[2]
    u = a_1_comb + a_2_comb
}

cols &lt;- c(&quot;original vector&quot;=&quot;red&quot;, &quot;multiplied vector&quot;=&quot;green&quot;, &quot;result&quot;=&quot;blue&quot;)
data = data.frame(rbind(c(0,0), a_1, c(0,0), a_2, c(0,0), a_1_comb, c(0,0), 
                        a_2_comb, a_1_comb, (a_1_comb+a_2_comb), c(0,0), u))

ggplot(data=NULL) +
  geom_segment(data=data[1:2,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color=&quot;original vector&quot;), arrow = arrow) +
  geom_segment(data=data[3:4,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color=&quot;original vector&quot;), arrow = arrow) +
  geom_segment(data=data[5:6,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2], 
                                    color=&quot;multiplied vector&quot;), arrow = arrow) +
  geom_segment(data=data[7:8,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color=&quot;multiplied vector&quot;), arrow = arrow) +
  geom_segment(data=data[9:10,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                     color=&quot;multiplied vector&quot;), arrow = arrow, lty=&quot;dashed&quot;) +
  geom_segment(data=data[11:12,], aes(x=X1[1], y=X2[1], xend=X1[2], yend=X2[2],
                                    color=&quot;result&quot;), arrow = arrow) +
  scale_colour_manual(name=&quot;Legend&quot;,values=cols) +
  ggtitle(&quot;Multiplication by a scalar&quot;) +
  xlab(&quot;x&quot;) + 
  ylab(&quot;y&quot;) +
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;, size=&quot;15&quot;),
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 15))</code></pre>
<p><img src="/post/2019-11-22-linear-algebra-basics_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ul>
<li>The solution is the vector of coefficient of the linear combination of the columns that gives the vector b</li>
<li>If the columns are dependent and the vector <span class="math inline">\(b\)</span> is not in the column space there is no solution</li>
<li>If the columns are dependent and the vector <span class="math inline">\(b\)</span> is in the column space there is an infinity of solutions</li>
</ul>
</div>
</div>
<div id="elimination" class="section level2">
<h2>Elimination</h2>
<p>Elimination produce an upper triangular syst√®me :</p>
<p><span class="math display">\[\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  a_{21}x + a_{22}y = b_2
\end{array}
\right.\]</span></p>
<p><span class="math display">\[\left\{
\begin{array}{l}
  a_{11}x + a_{12}y = b_1 \\
  cy = d
\end{array}
\right.\]</span></p>
<p>We multiply equation 1 to substract from equation 2 and eliminate a component. The solution is not altered by this process.</p>
<p><strong>Pivot</strong> : first non-zero in the rows that does the elimination</p>
<p><strong>Multiplier</strong> : (entry to eliminate) divided by (pivot)</p>
<pre class="r"><code>library(matrixcalc)

#adapts the size of the plot
options(repr.plot.width=16, repr.plot.height=6)

A = cbind(c(1,2), c(3,4))
b = c(3,4)

x = solve(A,b)

U = lu.decomposition(A)$U
L = lu.decomposition(A)$L

c = solve(L,b)
x = solve(U,c)

x_lim = c(min(x[1],0)-1,max(x[1],0)+1)
y_lim = c(min(x[2],0)-1,max(x[2],0)+1)

p1 &lt;- ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name=&quot;x&quot;, limits=x_lim) +
  scale_y_continuous(name=&quot;y&quot;, limits=y_lim) +
  geom_abline(slope=-(A[1,1]/A[1,2]), intercept=b[1]/A[1,2]) +
  geom_abline(slope=-(A[2,1]/A[2,2]), intercept=b[2]/A[2,2]) +
  geom_point(aes(x=x[1], y=x[2])) +
  ggtitle(&quot;Before elimination&quot;) +
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;, size=&quot;15&quot;))

p2 &lt;- ggplot(data=data.frame(rbind(v,w))) +
  scale_x_continuous(name=&quot;x&quot;, limits=x_lim) +
  scale_y_continuous(name=&quot;y&quot;, limits=y_lim) +
  geom_abline(slope=-(U[1,1]/U[1,2]), intercept=c[1]/U[1,2]) +
  geom_abline(slope=-(U[2,1]/U[2,2]), intercept=c[2]/U[2,2]) +
  geom_point(aes(x=x[1], y=x[2])) +
  ggtitle(&quot;After elimination&quot;) +
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;, size=&quot;15&quot;))

cowplot::plot_grid(p1, p2, labels = c(&quot;&quot;,&quot;&quot;))</code></pre>
<p><img src="/post/2019-11-22-linear-algebra-basics_files/figure-html/unnamed-chunk-5-1.png" width="672" />
```</p>
</div>
</div>
